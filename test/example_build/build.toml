max_order = 3

# Remove everything from the latest build
[[remove]]
source = "build/*"
ignore = "build/.gitkeep"
order = 0

# Copy others
[[copy]]
source = "src/components"
destination = "build/components"
order = 1

[[copy]]
source = "src/inc/*.php"
destination = "build/inc"
order = 1

[[copy]]
source = "src/*.php"
destination = "build"
order = 1

# Set styles
[[style]]
source = "src/style.scss"
destination = "build/app.css"
env = "dev"
order = 2
[style.options]
source_map = true

[[style]]
source = "src/style.scss"
destination = "build/app.css"
env = "prod"
order = 2
[style.options]
autoprefixer = "last 2 versions, IE 11"
minify = true

# Set scripts
[[script]]
source = "src/bootstrap.js"
destination = "build/app.js"
env = "dev"
order = 2
[script.options]
target = "web"
devtool = "source-map"
cache = true
debug = true
bail = true
[script.options.resolve]
root = ["working_dir:."]
extensions = ["", ".js"]
modules_directories = ["src"]
[[script.options.plugins]]
name = "define"
args = ["{ \"process.env.NODE_ENV\": \"development\" }"]

[[script]]
source = "src/bootstrap.js"
destination = "build/app.js"
env = "prod"
order = 2
[script.options]
target = "web"
bail = true
minify = true
[script.options.resolve]
root = ["working_dir:."]
extensions = ["", ".js", ".jsx"]
[[script.options.plugins]]
name = "dedupe"
[[script.options.plugins]]
name = "define"
args = ["{ \"process.env.NODE_ENV\": \"production\" }"]
